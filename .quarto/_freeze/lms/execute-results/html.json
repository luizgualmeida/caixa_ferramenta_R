{
  "hash": "bd9e0588a0608aadc4fdc919bce83bdc",
  "result": {
    "engine": "knitr",
    "markdown": "# Modelos Lineares {.unnumbered}\n\n::: {.callout-note appearance=\"simple\" icon=false}\n## Vis√£o Geral do Cap√≠tulo\n\nEste cap√≠tulo apresenta quatro abordagens fundamentais para an√°lise de dados longitudinais e correlacionados: **GLM de Medidas Repetidas**, **GEE**, **GMM** e **GzLM**. Cada modelo possui caracter√≠sticas espec√≠ficas que os tornam adequados para diferentes desenhos de pesquisa.\n:::\n\n---\n\n## üìä Os Quatro Modelos\n\n::: {.panel-tabset}\n\n### GLM - Medidas Repetidas\n\n**Modelo Linear Geral de Medidas Repetidas**\n\nExtens√£o do modelo linear tradicional projetado especificamente para dados com observa√ß√µes correlacionadas ao longo do tempo.\n\n**Quando usar:**\n- Estudos longitudinais com medi√ß√µes repetidas\n- Mesmos participantes avaliados em m√∫ltiplos momentos\n- Necessidade de modelar estrutura de covari√¢ncia entre medi√ß√µes\n\n**Exemplo pr√°tico:**\nAcompanhamento de pacientes em tratamento m√©dico, medindo regularmente biomarcadores para observar mudan√ßas ao longo do tempo.\n\n### GEE - Equa√ß√µes Estimadas\n\n**Generalized Estimated Equations**\n\nAbordagem robusta para dados longitudinais que fornece estimativas eficientes mesmo quando a especifica√ß√£o da covari√¢ncia n√£o √© perfeita.\n\n**Quando usar:**\n- Estudos observacionais longitudinais\n- Ensaios cl√≠nicos com medi√ß√µes correlacionadas\n- Estudos epidemiol√≥gicos multic√™ntricos\n\n**Exemplo pr√°tico:**\nInvestiga√ß√£o da efic√°cia de programa de interven√ß√£o em sa√∫de onde observa√ß√µes est√£o correlacionadas dentro de grupos de participantes.\n\n### GMM - Modelos Mistos\n\n**Modelos Mistos e Hier√°rquicos**\n\nCombinam componentes fixos e aleat√≥rios, ideais para dados com estrutura hier√°rquica ou multic√™ntrica.\n\n**Quando usar:**\n- Dados com estrutura hier√°rquica\n- Estudos multic√™ntricos\n- Observa√ß√µes agrupadas em diferentes n√≠veis\n\n**Exemplo pr√°tico:**\nAvalia√ß√£o de desempenho acad√™mico onde alunos (n√≠vel 1) est√£o agrupados em salas (n√≠vel 2) e escolas (n√≠vel 3), considerando efeitos individuais e contextuais.\n\n### GzLM - Lineares Generalizados\n\n**Generalized Linear Models**\n\nExtens√£o dos modelos lineares para vari√°veis resposta n√£o-normais, permitindo diferentes distribui√ß√µes e fun√ß√µes de liga√ß√£o.\n\n**Quando usar:**\n- Dados de contagem (Poisson)\n- Dados bin√°rios (Log√≠stica)\n- Dados com distribui√ß√£o n√£o-normal\n\n**Exemplo pr√°tico:**\nAn√°lise de n√∫mero de eventos adversos (contagem) em ensaio cl√≠nico ou modelagem de probabilidade de sucesso em tratamento (bin√°rio).\n\n:::\n\n---\n\n## üéØ Por que usar Modelos de Medidas Repetidas?\n\n::: {.callout-tip}\n## Vantagens sobre ANOVA Tradicional\n\nOs modelos lineares modernos oferecem melhorias substanciais sobre a ANOVA cl√°ssica:\n\n1. **Modelagem Flex√≠vel**\n   - M√∫ltiplos fatores independentes em um √∫nico modelo\n   - An√°lise de intera√ß√µes complexas\n   - Estruturas de covari√¢ncia personalizadas\n\n2. **Robustez a Viola√ß√µes**\n   - Dados desequilibrados\n   - Heterogeneidade de vari√¢ncias\n   - Desvios da normalidade\n\n3. **Controle Estat√≠stico**\n   - Inclus√£o de covari√°veis\n   - Ajuste para vari√°veis confundidoras\n   - Maior precis√£o nas estimativas\n\n4. **Poder Estat√≠stico**\n   - Aproveitamento da correla√ß√£o entre medidas\n   - Detec√ß√£o de efeitos com amostras menores\n   - An√°lise eficiente de designs complexos\n\n5. **Versatilidade**\n   - Vari√°veis dependentes cont√≠nuas ou categ√≥ricas\n   - Diferentes distribui√ß√µes de probabilidade\n   - Estruturas temporais variadas\n:::\n\n---\n\n## üì¶ Pacotes Necess√°rios\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelagem e an√°lise\nlibrary(lme4)        # Modelos lineares mistos\nlibrary(nlme)        # Modelos n√£o-lineares mistos\nlibrary(geepack)     # Equa√ß√µes de estima√ß√£o generalizadas\n\n# M√©dias e compara√ß√µes\nlibrary(emmeans)     # M√©dias estimadas marginais\nlibrary(multcomp)    # Compara√ß√µes m√∫ltiplas\nlibrary(effects)     # Visualiza√ß√£o de efeitos\n\n# Estat√≠sticas e diagn√≥sticos\nlibrary(performance) # Diagn√≥sticos de modelos\nlibrary(sjstats)     # Estat√≠sticas descritivas\nlibrary(rstatix)     # An√°lises simplificadas\nlibrary(car)         # Testes complementares\n\n# Manipula√ß√£o de dados\nlibrary(dplyr)       # Transforma√ß√£o de dados\nlibrary(tidyr)       # Organiza√ß√£o de dados\nlibrary(foreign)     # Importa√ß√£o SPSS/Stata\n\n# Visualiza√ß√£o\nlibrary(flexplot)    # Gr√°ficos flex√≠veis\nlibrary(see)         # Visualiza√ß√µes do easystats\n\n# Suites integradas\nlibrary(easystats)   # Suite completa de an√°lise\nlibrary(rempsyc)     # M√©todos psicom√©tricos\n```\n:::\n\n\n\n\n\n\n---\n\n## üì• Materiais para Download\n\n::: {.callout-important}\n## Arquivos Necess√°rios\n\nFa√ßa o download do pacote completo abaixo e **descompacte todos os arquivos na pasta do seu projeto**.\n\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n**Conte√∫do do pacote:**\n\n- `bd_New drug_respiratory&pulse.sav` - Banco de dados principal\n- `Lista 1.R` - Script parcialmente preenchido para pr√°tica\n- `lista_1.docx` - Exerc√≠cios para resolu√ß√£o\n:::\n\n---\n\n## üîÑ Prepara√ß√£o dos Dados\n\n### Carregamento Inicial\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importar dados do SPSS\noriginal_wide <- read.spss(\"bd_New drug_respiratory&pulse.sav\", \n                           to.data.frame = TRUE)\n\n# Visualizar estrutura\nhead(original_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      drug resp1 resp2 resp3 pulse1 pulse2 pulse3\n1 New Drug   3.4   3.3   3.3    2.2    2.1    2.1\n2 New Drug   3.4   3.4   3.3    2.2    2.1    2.2\n3 New Drug   3.3   3.4   3.4    2.3    2.4    2.3\n4 New Drug   3.4   3.4   3.4    2.3    2.4    2.3\n5 New Drug   3.3   3.4   3.3    2.2    2.2    2.4\n6 New Drug   3.3   3.3   3.3    2.0    2.1    2.4\n```\n\n\n:::\n:::\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n## Sobre a fun√ß√£o `read.spss()`\n\n- **Origem:** Pacote `foreign`\n- **Par√¢metro `to.data.frame = TRUE`:** Converte para data frame do R\n- **Alternativa:** Pacote `haven` com `read_sav()` (mais moderno)\n:::\n\n---\n\n### Transforma√ß√£o Wide ‚Üí Long\n\nPara an√°lises de medidas repetidas, precisamos converter os dados de formato **wide** (uma linha por sujeito) para **long** (uma linha por observa√ß√£o).\n\n#### Passo 1: Renomear Colunas\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbd <- original_wide %>%\n  rename_with(~gsub(\"(resp|pulse)(\\\\d+)\", \"\\\\1_\\\\2\", .), -drug) %>%\n  mutate(ID = row_number()) %>%\n  select(ID, everything())\n\nhead(bd)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  ID     drug resp_1 resp_2 resp_3 pulse_1 pulse_2 pulse_3\n1  1 New Drug    3.4    3.3    3.3     2.2     2.1     2.1\n2  2 New Drug    3.4    3.4    3.3     2.2     2.1     2.2\n3  3 New Drug    3.3    3.4    3.4     2.3     2.4     2.3\n4  4 New Drug    3.4    3.4    3.4     2.3     2.4     2.3\n5  5 New Drug    3.3    3.4    3.3     2.2     2.2     2.4\n6  6 New Drug    3.3    3.3    3.3     2.0     2.1     2.4\n```\n\n\n:::\n:::\n\n\n\n\n\n\n::: {.callout-tip collapse=\"true\"}\n## üîç Entendendo a Express√£o Regular\n\nA regex `(resp|pulse)(\\\\d+)` funciona assim:\n\n- `(resp|pulse)` - Captura \"resp\" **OU** \"pulse\"\n- `(\\\\d+)` - Captura um ou mais d√≠gitos\n\n**Transforma√ß√£o:**\n- `resp1` ‚Üí `resp_1`\n- `pulse2` ‚Üí `pulse_2`\n\nIsso facilita a separa√ß√£o posterior em vari√°vel e tempo!\n:::\n\n#### Passo 2: Pivotar para Formato Long\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbd_long <- pivot_longer(\n  bd,\n  cols = resp_1:pulse_3,\n  names_to = c(\".value\", \"Tempo\"),\n  names_pattern = \"(.+)_(.+)\"\n)\n\nhead(bd_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 5\n     ID drug     Tempo  resp pulse\n  <int> <fct>    <chr> <dbl> <dbl>\n1     1 New Drug 1       3.4   2.2\n2     1 New Drug 2       3.3   2.1\n3     1 New Drug 3       3.3   2.1\n4     2 New Drug 1       3.4   2.2\n5     2 New Drug 2       3.4   2.1\n6     2 New Drug 3       3.3   2.2\n```\n\n\n:::\n:::\n\n\n\n\n\n\n::: {.callout-note}\n## Estrutura do `pivot_longer()`\n\n- **`cols`:** Colunas a transformar\n- **`.value`:** Nome da coluna vem da primeira parte\n- **`Tempo`:** Criada da segunda parte do nome\n- **`names_pattern`:** Regex para dividir nomes\n:::\n\n#### Passo 3: Converter Tempo em Fator\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbd_long$Tempo <- factor(bd_long$Tempo)\n```\n:::\n\n\n\n\n\n\n---\n\n## ‚úÖ Verifica√ß√£o de Pressupostos\n\n### Normalidade da Vari√°vel Dependente\n\nA distribui√ß√£o normal √© pressuposto fundamental em muitos testes estat√≠sticos.\n\n::: {.panel-tabset}\n\n#### Distribui√ß√£o Normal\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\ndados_normais <- rnorm(1000, mean = 0, sd = 1)\n\n# Criar visualiza√ß√µes\npar(mfrow = c(1, 2))\n\n# Histograma\nhist(dados_normais, \n     main = \"Distribui√ß√£o Normal\",\n     col = \"lightblue\", \n     border = \"black\")\n\n# Q-Q Plot\nqqnorm(dados_normais, main = \"Q-Q Plot - Normal\")\nqqline(dados_normais, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](lms_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n\n\n\n**Caracter√≠sticas:**\n- Histograma em forma de sino\n- Q-Q plot segue linha diagonal\n- Simetria em torno da m√©dia\n\n#### Distribui√ß√£o N√£o-Normal\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\ndados_nao_normais <- abs(rnorm(1000, mean = 0, sd = 1))\n\npar(mfrow = c(1, 2))\n\nhist(dados_nao_normais,\n     main = \"Distribui√ß√£o Assim√©trica\",\n     col = \"lightcoral\",\n     border = \"black\")\n\nqqnorm(dados_nao_normais, main = \"Q-Q Plot - N√£o Normal\")\nqqline(dados_nao_normais, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](lms_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\n```\n:::\n\n\n\n\n\n\n**Caracter√≠sticas:**\n- Assimetria evidente\n- Desvios da linha no Q-Q plot\n- Concentra√ß√£o em uma regi√£o\n\n:::\n\n---\n\n### Teste de Shapiro-Wilk\n\n::: {.callout-note}\n## Hip√≥teses do Teste\n\n**H‚ÇÄ:** Os dados seguem distribui√ß√£o normal  \n**H‚ÇÅ:** Os dados N√ÉO seguem distribui√ß√£o normal\n\n**Decis√£o:**\n- p > 0,05 ‚Üí N√£o rejeita H‚ÇÄ (assume normalidade)\n- p < 0,05 ‚Üí Rejeita H‚ÇÄ (evid√™ncia de n√£o-normalidade)\n\n‚ö†Ô∏è **Aten√ß√£o:** Com amostras muito grandes, pequenos desvios podem ser significativos.\n:::\n\n**Exemplo com dados normais:**\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(dados_normais)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  dados_normais\nW = 0.99838, p-value = 0.4765\n```\n\n\n:::\n:::\n\n\n\n\n\n\n**Exemplo com dados n√£o-normais:**\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(dados_nao_normais)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  dados_nao_normais\nW = 0.92344, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n\n\n---\n\n### Normalidade das Vari√°veis do Estudo\n\n#### Vari√°vel \"Pulse\"\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualiza√ß√£o combinada\nnice_normality(\n  data = bd_long,\n  variable = \"pulse\",\n  histogram = TRUE\n)\n```\n\n::: {.cell-output-display}\n![](lms_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Teste formal\nshapiro.test(bd_long$pulse)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  bd_long$pulse\nW = 0.90791, p-value = 0.005655\n```\n\n\n:::\n:::\n\n\n\n\n\n\n::: {.callout-warning}\n## Interpreta√ß√£o\n\nTanto a an√°lise gr√°fica quanto o teste de Shapiro-Wilk indicam que **pulse n√£o possui distribui√ß√£o normal**.\n:::\n\n---\n\n## üîÑ Esfericidade (Medidas Repetidas)\n\n::: {.callout-important}\n## O que √© Esfericidade?\n\nA **esfericidade** avalia se as vari√¢ncias das diferen√ßas entre todos os pares de medidas repetidas s√£o homog√™neas.\n\n**Viola√ß√£o de esfericidade:**\n- Infla erro Tipo I (falsos positivos)\n- Requer corre√ß√µes nos graus de liberdade\n- Comum em medidas repetidas\n:::\n\n### Teste de Mauchly para \"Pulse\"\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npulse_mauchly <- anova_test(\n  data = bd_long,\n  dv = pulse,\n  wid = ID,\n  within = Tempo\n)\n\npulse_mauchly\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nANOVA Table (type III tests)\n\n$ANOVA\n  Effect DFn DFd    F     p p<.05   ges\n1  Tempo   2  22 3.48 0.049     * 0.024\n\n$`Mauchly's Test for Sphericity`\n  Effect     W    p p<.05\n1  Tempo 0.781 0.29      \n\n$`Sphericity Corrections`\n  Effect  GGe      DF[GG] p[GG] p[GG]<.05   HFe      DF[HF] p[HF] p[HF]<.05\n1  Tempo 0.82 1.64, 18.04 0.061           0.945 1.89, 20.78 0.052          \n```\n\n\n:::\n:::\n\n\n\n\n\n\n::: {.callout-tip collapse=\"true\"}\n## üìä Interpretando os Resultados\n\n**ANOVA Table:**\n- **F** = 3,48, **p** = 0,049 ‚Üí Efeito significativo de Tempo\n- **ges** = medida de tamanho de efeito\n\n**Teste de Mauchly:**\n- **W** = 0,781, **p** = 0,29 ‚Üí Esfericidade N√ÉO violada\n\n**Corre√ß√µes (quando necess√°rias):**\n- **GGe** = 0,82 ‚Üí Corre√ß√£o de Greenhouse-Geisser\n- **HFe** = 0,945 ‚Üí Corre√ß√£o de Huynh-Feldt\n:::\n\n---\n\n### Teste de Mauchly para \"Resp\"\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresp_mauchly <- anova_test(\n  data = bd_long,\n  dv = resp,\n  wid = ID,\n  within = Tempo\n)\n\nresp_mauchly\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nANOVA Table (type III tests)\n\n$ANOVA\n  Effect DFn DFd     F     p p<.05  ges\n1  Tempo   2  22 0.344 0.713       0.01\n\n$`Mauchly's Test for Sphericity`\n  Effect     W     p p<.05\n1  Tempo 0.501 0.032     *\n\n$`Sphericity Corrections`\n  Effect   GGe      DF[GG] p[GG] p[GG]<.05   HFe      DF[HF] p[HF] p[HF]<.05\n1  Tempo 0.667 1.33, 14.68 0.629           0.725 1.45, 15.94 0.646          \n```\n\n\n:::\n:::\n\n\n\n\n\n\n::: {.callout-warning}\n## ‚ö†Ô∏è Esfericidade Violada!\n\n**Teste de Mauchly:**\n- **W** = 0,501, **p** < 0,05 ‚Üí Esfericidade VIOLADA\n\n**Implica√ß√µes:**\n- Graus de liberdade devem ser corrigidos\n- Usar valores p corrigidos (GGe ou HFe)\n- GGe = 0,667 (redu√ß√£o de ~33%)\n- HFe = 0,725 (redu√ß√£o de ~27,5%)\n\n**Resultado ap√≥s corre√ß√£o:**\n- Efeito de Tempo permanece n√£o-significativo\n:::\n\n---\n\n## üîß Coeficientes de Corre√ß√£o\n\n::: {.panel-tabset}\n\n### Greenhouse-Geisser (GGe)\n\n**Caracter√≠sticas:**\n- Corre√ß√£o mais conservadora\n- Recomendado quando GGe < 0,75\n- Reduz graus de liberdade proporcionalmente\n\n**Interpreta√ß√£o:**\n- GGe pr√≥ximo de 1 ‚Üí Pouca viola√ß√£o\n- GGe < 0,75 ‚Üí Viola√ß√£o substancial\n\n**Exemplo (Resp):**\n- GGe = 0,667 ‚Üí Redu√ß√£o de 33% nos GL\n\n### Huynh-Feldt (HFe)\n\n**Caracter√≠sticas:**\n- Menos conservador que GGe\n- Melhor para amostras pequenas\n- Pode exceder 1 (truncado em 1)\n\n**Interpreta√ß√£o:**\n- HFe pr√≥ximo de 1 ‚Üí Pouca viola√ß√£o\n- Diferen√ßa com GGe indica severidade\n\n**Exemplo (Resp):**\n- HFe = 0,725 ‚Üí Redu√ß√£o de 27,5% nos GL\n\n### Quando Usar Qual?\n\n| Situa√ß√£o | Recomenda√ß√£o |\n|----------|--------------|\n| GGe > 0,75 | Qualquer corre√ß√£o |\n| GGe < 0,75 | Preferir GGe |\n| Amostra pequena | Considerar HFe |\n| p pr√≥ximo de 0,05 | Comparar ambos |\n\n:::\n\n---\n\n## üéì Resumo dos Pressupostos\n\n::: {.callout-note appearance=\"simple\"}\n## Checklist de Verifica√ß√£o\n\n| Pressuposto | Pulse | Resp | A√ß√£o |\n|-------------|-------|------|------|\n| Normalidade | ‚ùå Violado | - | Considerar transforma√ß√£o ou GLM robusto |\n| Esfericidade | ‚úÖ OK | ‚ùå Violado | Usar corre√ß√µes GGe/HFe |\n| Homogeneidade | - | - | Verificar com Levene (pr√≥ximo cap√≠tulo) |\n\n**Pr√≥ximos passos:** Agora que verificamos os pressupostos, podemos prosseguir para as an√°lises GLM, GEE e GMM!\n:::\n\n---\n\n## üìö Conceitos-Chave\n\n::: {.callout-tip collapse=\"true\"}\n## Gloss√°rio R√°pido\n\n**Wide vs Long:**\n- Wide: Uma linha por sujeito, m√∫ltiplas colunas de tempo\n- Long: Uma linha por observa√ß√£o, coluna de tempo\n\n**Esfericidade:**\n- Homogeneidade das vari√¢ncias das diferen√ßas\n- Cr√≠tico para ANOVA de medidas repetidas\n\n**GGe/HFe:**\n- Corre√ß√µes para viola√ß√£o de esfericidade\n- Ajustam graus de liberdade\n\n**Q-Q Plot:**\n- Quantis observados vs esperados\n- Linha diagonal = normalidade perfeita\n:::\n\n---\n\n::: {.callout-note appearance=\"simple\"}\n## üöÄ Pronto para An√°lises!\n\nCom os dados preparados e pressupostos verificados, voc√™ est√° pronto para explorar:\n\n1. **GLM** - Modelo Linear Geral\n2. **GEE** - Equa√ß√µes de Estima√ß√£o Generalizadas  \n3. **GMM** - Modelos Mistos\n4. **GzLM** - Modelos Lineares Generalizados\n\nSiga para os pr√≥ximos cap√≠tulos onde implementaremos cada modelo em detalhe!\n:::",
    "supporting": [
      "lms_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}