{
  "hash": "9d19c6ffaa4fc0d2fb26b5f3a806cc4b",
  "result": {
    "engine": "knitr",
    "markdown": "# Lista 2 - GEE\n\n## Introdu√ß√£o\n\n\n\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n\n\nNa lista 2 vamos utilizar mais uma vez o banco de dados [New Drug](https://drive.google.com/file/d/145uyQOn_3Mk_CQxpu-pFKfm8u7DE257U/view?usp=sharing) com medidas de resp e pulse. N√£o se esque√ßa de transform√°-lo para o formato long como no exerc√≠cio anterior.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar o banco de dados e armazena na vari√°vel original_wide\n\noriginal_wide = read.spss(\"bd_New drug_respiratory&pulse.sav\", to.data.frame=TRUE) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Renomear as colunas do banco de dados para facilitar a convers√£o para o formato longo.\n\nbd <- original_wide %>%   rename_with(~gsub(\"(resp|pulse)(\\\\d+)\", \"\\\\1_\\\\2\", .), -drug) %>%  mutate(ID = row_number()) %>% dplyr::select(ID, everything())  \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Organizar os dados para o formato longo\n\nbd_long = pivot_longer(bd, cols=resp_1:pulse_3, names_to = c(\".value\", \"Tempo\"),   names_pattern = \"(.+)_(.+)\")  \n```\n:::\n\n\n\n\n\n\n\n\nPrimeiras linhas do banco de dados depois de transformado.\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(bd_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 5\n     ID drug     Tempo  resp pulse\n  <int> <fct>    <chr> <dbl> <dbl>\n1     1 New Drug 1       3.4   2.2\n2     1 New Drug 2       3.3   2.1\n3     1 New Drug 3       3.3   2.1\n4     2 New Drug 1       3.4   2.2\n5     2 New Drug 2       3.4   2.1\n6     2 New Drug 3       3.3   2.2\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n------------------------------------------------------------------------\n\n## Exerc√≠cios\n\n### a) GEE com a VD \"Pulse\"\n\nUtilize um GEE para verificar o efeito de tempo e grupo sobre os resultados de resp e pulse. Fa√ßa 3 modelos para cada vari√°vel dependente (com as distribui√ß√µes Normal, Gamma e Tweedie) e cole aqui apenas as tabelas relevantes para a an√°lise.\n\n#### **Distribui√ß√£o normal**\n\n##### Criando o modelo\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_gee_tweedie <- glmmTMB::glmmTMB(formula = resp ~ Tempo*drug + us(1 + Tempo | ID),\n                                      family = gaussian(),# tweedie(var.power = 1.5, link.power = 0),  # Definindo a fam√≠lia Tweedie\n                                      data = bd_long  # Seu conjunto de dados\n  #corstr = \"exchangeable\"  # Estrutura de correla√ß√£o (pode ser \"independence\", \"exchangeable\", etc.)\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in finalizeTMB(TMBStruc, obj, fit, h, data.tmb.old): Model convergence\nproblem; non-positive-definite Hessian matrix. See vignette('troubleshooting')\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(model_gee_tweedie)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA\n```\n\n\n:::\n\n```{.r .cell-code}\nrm(model_gee_tweedie)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_gee_pulse_normal <- geeglm(pulse ~ drug + Tempo + drug*Tempo, \n                           data = bd_long,         \n                           id = ID,                 \n                           family = gaussian, #Distribui√ß√£o normal      \n                           corstr = \"unstructured\")\n```\n:::\n\n\n\n\n\n\n\n\n##### Resumo do modelo e contrastes\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(modelo_gee_pulse_normal)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\ngeeglm(formula = pulse ~ drug + Tempo + drug * Tempo, family = gaussian, \n    data = bd_long, id = ID, corstr = \"unstructured\")\n\n Coefficients:\n                   Estimate Std.err     Wald Pr(>|W|)    \n(Intercept)         2.20000 0.04082 2904.000  < 2e-16 ***\ndrugPlacebo         0.46667 0.05092   84.000  < 2e-16 ***\nTempo2              0.01667 0.03664    0.207  0.64921    \nTempo3              0.08333 0.06838    1.485  0.22297    \ndrugPlacebo:Tempo2  0.13333 0.04194   10.105  0.00148 ** \ndrugPlacebo:Tempo3  0.03333 0.08767    0.145  0.70377    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation structure = unstructured \nEstimated Scale Parameters:\n\n            Estimate  Std.err\n(Intercept)  0.00963 0.001676\n  Link = identity \n\nEstimated Correlation Parameters:\n          Estimate Std.err\nalpha.1:2   0.7212  0.1690\nalpha.1:3  -0.2885  0.2076\nalpha.2:3   0.1154  0.2665\nNumber of clusters:   12  Maximum cluster size: 3 \n```\n\n\n:::\n\n```{.r .cell-code}\nemmeans(modelo_gee_pulse_normal, pairwise ~ drug*Tempo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$emmeans\n drug     Tempo emmean     SE df lower.CL upper.CL\n New Drug 1       2.20 0.0408 30     2.12     2.28\n Placebo  1       2.67 0.0304 30     2.60     2.73\n New Drug 2       2.22 0.0549 30     2.10     2.33\n Placebo  2       2.82 0.0280 30     2.76     2.87\n New Drug 3       2.28 0.0436 30     2.19     2.37\n Placebo  3       2.78 0.0366 30     2.71     2.86\n\nCovariance estimate used: vbeta \nConfidence level used: 0.95 \n\n$contrasts\n contrast                          estimate     SE df t.ratio p.value\n New Drug Tempo1 - Placebo Tempo1   -0.4667 0.0509 30  -9.165  <.0001\n New Drug Tempo1 - New Drug Tempo2  -0.0167 0.0366 30  -0.455  0.9973\n New Drug Tempo1 - Placebo Tempo2   -0.6167 0.0495 30 -12.449  <.0001\n New Drug Tempo1 - New Drug Tempo3  -0.0833 0.0684 30  -1.219  0.8244\n New Drug Tempo1 - Placebo Tempo3   -0.5833 0.0549 30 -10.634  <.0001\n Placebo Tempo1 - New Drug Tempo2    0.4500 0.0627 30   7.173  <.0001\n Placebo Tempo1 - Placebo Tempo2    -0.1500 0.0204 30  -7.348  <.0001\n Placebo Tempo1 - New Drug Tempo3    0.3833 0.0531 30   7.213  <.0001\n Placebo Tempo1 - Placebo Tempo3    -0.1167 0.0549 30  -2.127  0.3013\n New Drug Tempo2 - Placebo Tempo2   -0.6000 0.0616 30  -9.738  <.0001\n New Drug Tempo2 - New Drug Tempo3  -0.0667 0.0609 30  -1.095  0.8793\n New Drug Tempo2 - Placebo Tempo3   -0.5667 0.0660 30  -8.590  <.0001\n Placebo Tempo2 - New Drug Tempo3    0.5333 0.0518 30  10.292  <.0001\n Placebo Tempo2 - Placebo Tempo3     0.0333 0.0509 30   0.655  0.9855\n New Drug Tempo3 - Placebo Tempo3   -0.5000 0.0569 30  -8.783  <.0001\n\nP value adjustment: tukey method for comparing a family of 6 estimates \n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n##### Verificando os pressupostos\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotar o diagn√≥stico do modelo GEE para a vari√°vel 'pulse'\n\ncheck_model(modelo_gee_pulse_normal)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nConverting missing values (`NA`) into regular values currently not\n  possible for variables of class `NULL`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nFailed to compute posterior predictive checks with `re_formula=NULL`.\n  Trying again with `re_formula=NA` now.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lista_2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n##### Plot dos resultados\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Salvando os resultados do modelo em uma vari√°vel\n\nmeans_ci_normal = emmeans(modelo_gee_pulse_normal, specs = ~drug:Tempo)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotar as m√©dias e intervalos de confian√ßa\n\nggplot(as.data.frame(means_ci_normal), aes(x = Tempo, y = emmean, color = drug)) +\n  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, position = position_dodge(0.8)) +\n  geom_point(position = position_dodge(0.8), size = 3) +\n  labs(title = \"Distribui√ß√£o Normal\",\n       x = \"Tempo\",\n       y = \"Pulse\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](lista_2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n------------------------------------------------------------------------\n\n#### **Distribui√ß√£o gamma**\n\n##### Criando o modelo\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_gee_pulse_gamma <- geeglm(pulse ~ drug + Tempo + drug*Tempo, \n                           data = bd_long,         \n                           id = ID,                 \n                           family = Gamma(link = \"identity\"), #Distribui√ß√£o Gamma      \n                           corstr = \"unstructured\")\n```\n:::\n\n\n\n\n\n\n\n\n##### Resumo do modelo e contrastes\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(modelo_gee_pulse_gamma)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\ngeeglm(formula = pulse ~ drug + Tempo + drug * Tempo, family = Gamma(link = \"identity\"), \n    data = bd_long, id = ID, corstr = \"unstructured\")\n\n Coefficients:\n                   Estimate Std.err    Wald Pr(>|W|)    \n(Intercept)          2.2000  0.0408 2904.00   <2e-16 ***\ndrugPlacebo          0.4667  0.0509   84.00   <2e-16 ***\nTempo2               0.0167  0.0366    0.21   0.6492    \nTempo3               0.0833  0.0684    1.49   0.2230    \ndrugPlacebo:Tempo2   0.1333  0.0419   10.11   0.0015 ** \ndrugPlacebo:Tempo3   0.0333  0.0877    0.14   0.7038    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation structure = unstructured \nEstimated Scale Parameters:\n\n            Estimate  Std.err\n(Intercept)  0.00172 0.000372\n  Link = identity \n\nEstimated Correlation Parameters:\n          Estimate Std.err\nalpha.1:2    0.745   0.178\nalpha.1:3   -0.279   0.208\nalpha.2:3    0.156   0.279\nNumber of clusters:   12  Maximum cluster size: 3 \n```\n\n\n:::\n\n```{.r .cell-code}\nemmeans(modelo_gee_pulse_gamma, pairwise ~ drug*Tempo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$emmeans\n drug     Tempo emmean     SE df lower.CL upper.CL\n New Drug 1       2.20 0.0408 30     2.12     2.28\n Placebo  1       2.67 0.0304 30     2.60     2.73\n New Drug 2       2.22 0.0549 30     2.10     2.33\n Placebo  2       2.82 0.0281 30     2.76     2.87\n New Drug 3       2.28 0.0436 30     2.19     2.37\n Placebo  3       2.78 0.0366 30     2.71     2.86\n\nCovariance estimate used: vbeta \nConfidence level used: 0.95 \n\n$contrasts\n contrast                          estimate     SE df t.ratio p.value\n New Drug Tempo1 - Placebo Tempo1    -0.467 0.0509 30  -9.170  <.0001\n New Drug Tempo1 - New Drug Tempo2   -0.017 0.0366 30  -0.450  0.9970\n New Drug Tempo1 - Placebo Tempo2    -0.617 0.0495 30 -12.450  <.0001\n New Drug Tempo1 - New Drug Tempo3   -0.083 0.0684 30  -1.220  0.8240\n New Drug Tempo1 - Placebo Tempo3    -0.583 0.0549 30 -10.630  <.0001\n Placebo Tempo1 - New Drug Tempo2     0.450 0.0627 30   7.170  <.0001\n Placebo Tempo1 - Placebo Tempo2     -0.150 0.0204 30  -7.350  <.0001\n Placebo Tempo1 - New Drug Tempo3     0.383 0.0531 30   7.210  <.0001\n Placebo Tempo1 - Placebo Tempo3     -0.117 0.0549 30  -2.130  0.3010\n New Drug Tempo2 - Placebo Tempo2    -0.600 0.0616 30  -9.740  <.0001\n New Drug Tempo2 - New Drug Tempo3   -0.067 0.0609 30  -1.100  0.8790\n New Drug Tempo2 - Placebo Tempo3    -0.567 0.0660 30  -8.590  <.0001\n Placebo Tempo2 - New Drug Tempo3     0.533 0.0518 30  10.290  <.0001\n Placebo Tempo2 - Placebo Tempo3      0.033 0.0509 30   0.650  0.9860\n New Drug Tempo3 - Placebo Tempo3    -0.500 0.0569 30  -8.780  <.0001\n\nP value adjustment: tukey method for comparing a family of 6 estimates \n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n##### Verificando os pressupostos\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotar o diagn√≥stico do modelo GEE para a vari√°vel 'pulse'\n\ncheck_model(modelo_gee_pulse_gamma)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nConverting missing values (`NA`) into regular values currently not\n  possible for variables of class `NULL`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nFailed to compute posterior predictive checks with `re_formula=NULL`.\n  Trying again with `re_formula=NA` now.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCannot simulate residuals for models of class `geeglm`. Please try\n  `check_model(..., residual_type = \"normal\")` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lista_2_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n##### Plot dos resultados\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Salvando os resultados do modelo em uma vari√°vel\n\nmeans_ci_gamma = emmeans(modelo_gee_pulse_gamma, specs = ~drug:Tempo)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotar as m√©dias e intervalos de confian√ßa\n\nggplot(as.data.frame(means_ci_gamma), aes(x = Tempo, y = emmean, color = drug)) +\n  geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2, position = position_dodge(0.8)) +\n  geom_point(position = position_dodge(0.8), size = 3) +\n  labs(title = \"Distribui√ß√£o Gamma\",\n       x = \"Tempo\",\n       y = \"Pulse\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](lista_2_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n------------------------------------------------------------------------\n\n#### **Distribui√ß√£o tweedie**\n\n##### Criando o modelo\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo_gee_pulse_tweedie <- glm(pulse ~ drug + Tempo + drug*Tempo, \n                           data = bd_long,\n                          # id = ID, \n                           family = tweedie(var.power=2, link.power = 0),\n                          contrasts = )\n```\n:::\n\n\n\n\n\n\n\n\n::: callout-warning\n#### Aviso!\n\nUtilizamos a fun√ß√£o glm para criar o modelo Tweedie. Estamos trabalhando para criar o modelo com a fun√ß√£o GEE. Por hora utilize o SPSSü§Æ.\n:::\n\n<!-- ```{r} outra maneira de fazer o modelo tweedie-->\n\n<!-- #| echo: true -->\n\n<!-- #| message: false -->\n\n<!-- #| warning: false -->\n\n<!-- mepsdsgn = svydesign( -->\n\n<!--   id = ~ID, -->\n\n<!--   strata = ~drug, -->\n\n<!--   #weights = ~perwt20f, -->\n\n<!--   data = bd_long, -->\n\n<!--   nest = TRUE) -->\n\n<!-- modelo_gee_pulse_tweedie2 <- svyglm(pulse ~ drug + Tempo + drug*Tempo,  -->\n\n<!--                            mepsdsgn, -->\n\n<!--                           # id = ID,  -->\n\n<!--                            family = tweedie(var.power=2, link.power = 0)) -->\n\n<!-- ``` -->\n\n##### Resumo do modelo e contrastes\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(modelo_gee_pulse_tweedie)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = pulse ~ drug + Tempo + drug * Tempo, family = tweedie(var.power = 2, \n    link.power = 0), data = bd_long)\n\nCoefficients:\n                   Estimate Std. Error t value Pr(>|t|)    \n(Intercept)         0.78846    0.01857   42.47  < 2e-16 ***\ndrugPlacebo         0.19237    0.02626    7.33  3.7e-08 ***\nTempo2              0.00755    0.02626    0.29     0.78    \nTempo3              0.03718    0.02626    1.42     0.17    \ndrugPlacebo:Tempo2  0.04718    0.03713    1.27     0.21    \ndrugPlacebo:Tempo3  0.00564    0.03713    0.15     0.88    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Tweedie family taken to be 0.00207)\n\n    Null deviance: 0.473395  on 35  degrees of freedom\nResidual deviance: 0.062212  on 30  degrees of freedom\nAIC: NA\n\nNumber of Fisher Scoring iterations: 3\n```\n\n\n:::\n\n```{.r .cell-code}\nemmeans(modelo_gee_pulse_tweedie, pairwise ~ drug*Tempo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$emmeans\n drug     Tempo emmean     SE  df asymp.LCL asymp.UCL\n New Drug 1      0.788 0.0186 Inf     0.752     0.825\n Placebo  1      0.981 0.0186 Inf     0.944     1.017\n New Drug 2      0.796 0.0186 Inf     0.760     0.832\n Placebo  2      1.036 0.0186 Inf     0.999     1.072\n New Drug 3      0.826 0.0186 Inf     0.789     0.862\n Placebo  3      1.024 0.0186 Inf     0.987     1.060\n\nResults are given on the mu^0 (not the response) scale. \nConfidence level used: 0.95 \n\n$contrasts\n contrast                          estimate     SE  df z.ratio p.value\n New Drug Tempo1 - Placebo Tempo1   -0.1924 0.0263 Inf  -7.330  <.0001\n New Drug Tempo1 - New Drug Tempo2  -0.0075 0.0263 Inf  -0.290  1.0000\n New Drug Tempo1 - Placebo Tempo2   -0.2471 0.0263 Inf  -9.410  <.0001\n New Drug Tempo1 - New Drug Tempo3  -0.0372 0.0263 Inf  -1.420  0.7170\n New Drug Tempo1 - Placebo Tempo3   -0.2352 0.0263 Inf  -8.960  <.0001\n Placebo Tempo1 - New Drug Tempo2    0.1848 0.0263 Inf   7.040  <.0001\n Placebo Tempo1 - Placebo Tempo2    -0.0547 0.0263 Inf  -2.080  0.2950\n Placebo Tempo1 - New Drug Tempo3    0.1552 0.0263 Inf   5.910  <.0001\n Placebo Tempo1 - Placebo Tempo3    -0.0428 0.0263 Inf  -1.630  0.5780\n New Drug Tempo2 - Placebo Tempo2   -0.2395 0.0263 Inf  -9.120  <.0001\n New Drug Tempo2 - New Drug Tempo3  -0.0296 0.0263 Inf  -1.130  0.8700\n New Drug Tempo2 - Placebo Tempo3   -0.2276 0.0263 Inf  -8.670  <.0001\n Placebo Tempo2 - New Drug Tempo3    0.2099 0.0263 Inf   7.990  <.0001\n Placebo Tempo2 - Placebo Tempo3     0.0119 0.0263 Inf   0.450  0.9980\n New Drug Tempo3 - Placebo Tempo3   -0.1980 0.0263 Inf  -7.540  <.0001\n\nNote: contrasts are still on the mu^0 scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nP value adjustment: tukey method for comparing a family of 6 estimates \n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n##### Verificando os pressupostos\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotar o diagn√≥stico do modelo GEE para a vari√°vel 'pulse'\n\ncheck_model(modelo_gee_pulse_tweedie)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nCannot simulate residuals for models of class `glm`. Please try\n  `check_model(..., residual_type = \"normal\")` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lista_2_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n##### Plot dos resultados\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Salvando os resultados do modelo em uma vari√°vel\n\nmeans_ci_tweedie = emmeans(modelo_gee_pulse_tweedie, specs = ~drug:Tempo)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plotar as m√©dias e intervalos de confian√ßa\n\nggplot(as.data.frame(means_ci_tweedie), aes(x = Tempo, y = emmean, color = drug)) +\n  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, position = position_dodge(0.8)) +\n  geom_point(position = position_dodge(0.8), size = 3) +\n  labs(title = \"Distribui√ß√£o Tweedie\",\n       x = \"Tempo\",\n       y = \"Pulse\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](lista_2_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n------------------------------------------------------------------------\n\n### b) QIC\n\nCompare cada um dos modelos com diferentes distribui√ß√µes utilizando o QIC (Quasi Likehood Independence Criterion). Os modelos t√™m diferen√ßa entre si nos resultados?\n\n::: callout-note\n#### Nota\n\nA fun√ß√£o `QIC()` n√£o funciona para modelos gerados com as fun√ß√µes glm e lm, apenas com o GEE. Resolveremos em breve! Por hora utilize o SPSSü§Æ.\n:::\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nQIC(modelo_gee_pulse_normal)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      QIC      QICu Quasi Lik       CIC    params      QICC \n   12.347    12.347    -0.173     6.000     6.000   102.347 \n```\n\n\n:::\n\n```{.r .cell-code}\nQIC(modelo_gee_pulse_gamma)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      QIC      QICu Quasi Lik       CIC    params      QICC \n    125.2     125.2     -56.6       6.0       6.0     215.2 \n```\n\n\n:::\n\n```{.r .cell-code}\n#QIC(modelo_gee_pulse_tweedie)\n```\n:::\n\n\n\n\n\n\n\n\n### c) Sumarizando os resultados\n\n::: callout-note\n#### Nota\n\nA fun√ß√£o `report()` n√£o funciona para modelos gerados com as fun√ß√µes GEE. Aproveite para treinar a escrita no formato de uma publica√ß√£o acad√™mica.\n:::\n\n#### Resutados com distribui√ß√£o Tweedie\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreport(modelo_gee_pulse_tweedie)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWe fitted a general linear model (Tweedie family with a mu^0 link) (estimated\nusing ML) to predict pulse with drug and Tempo (formula: pulse ~ drug + Tempo +\ndrug * Tempo). The model's explanatory power is substantial (Nagelkerke's R2 =\n0.87). The model's intercept, corresponding to drug = New Drug and Tempo = 1,\nis at 0.79 (95% CI [0.75, 0.83], p < .001). Within this model:\n\n  - The effect of drug [Placebo] is statistically significant and positive (beta\n= 0.19, 95% CI [0.14, 0.24], p < .001; Std. beta = 0.19, 95% CI [0.14, 0.24])\n  - The effect of Tempo [2] is statistically non-significant and positive (beta =\n7.55e-03, 95% CI [-0.04, 0.06], p = 0.774; Std. beta = 7.55e-03, 95% CI [-0.04,\n0.06])\n  - The effect of Tempo [3] is statistically non-significant and positive (beta =\n0.04, 95% CI [-0.01, 0.09], p = 0.157; Std. beta = 0.04, 95% CI [-0.01, 0.09])\n  - The effect of drug [Placebo] √ó Tempo [2] is statistically non-significant and\npositive (beta = 0.05, 95% CI [-0.03, 0.12], p = 0.204; Std. beta = 0.05, 95%\nCI [-0.03, 0.12])\n  - The effect of drug [Placebo] √ó Tempo [3] is statistically non-significant and\npositive (beta = 5.64e-03, 95% CI [-0.07, 0.08], p = 0.879; Std. beta =\n5.64e-03, 95% CI [-0.07, 0.08])\n\nStandardized parameters were obtained by fitting the model on a standardized\nversion of the dataset. 95% Confidence Intervals (CIs) and p-values were\ncomputed using a Wald z-distribution approximation.\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n## Considera√ß√µes finais\n\nRealizamos todas as an√°lises para a VD Pulse! Agora fa√ßa as an√°lises para a vari√°vel Reps!\n\n::: callout-tip\n#### Dica!\n\nN√£o fa√ßa apenas um copy/paste dos scripts! Treine escrever os c√≥digos e lembre-se de mudar o nome das vari√°veis do modelo para que n√£o ocorra nenhum conflito! Compare seus resultados com os da aula pr√°tica.\n:::\n\n## Lista 2 resolvida no SPSS\n\n\n\n\n\n\n\n\n{{< video https://www.youtube.com/watch?v=qd0qF2lRqIs title='GEE - Generalized Estimated Equations - Aula Pr√°tica #2 (SPSS)' >}}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Refer√™ncias\n\n## Vers√µes dos pacotes\n\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreport(sessionInfo())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalyses were conducted using the R Statistical language (version 4.3.3; R Core\nTeam, 2024) on Windows 11 x64 (build 22631), using the packages lme4 (version\n1.1.35.5; Bates D et al., 2015), Matrix (version 1.6.5; Bates D et al., 2024),\neffectsize (version 0.8.9; Ben-Shachar MS et al., 2020), gee (version 4.13.27;\nCarey VJ, 2024), pwr (version 1.3.0; Champely S, 2020), htmltools (version\n0.5.8.1; Cheng J et al., 2024), fitdistrplus (version 1.2.1; Delignette-Muller\nML, Dutang C, 2015), tweedie (version 2.3.5; Dunn PK, Smyth GK, 2005), tm\n(version 0.7.14; Feinerer I, Hornik K, 2024), flexplot (version 0.21.2; Fife,\nD, 2022), effects (version 4.2.2; Fox J, Weisberg S, 2019), car (version 3.1.3;\nFox J, Weisberg S, 2019), carData (version 3.0.5; Fox J et al., 2022), mvtnorm\n(version 1.3.2; Genz A, Bretz F, 2009), statmod (version 1.5.0; Giner G, Smyth\nGK, 2016), geepack (version 1.3.11; Halekoh U et al., 2006), NLP (version\n0.3.0; Hornik K, 2024), TH.data (version 1.1.2; Hothorn T, 2023), multcomp\n(version 1.4.26; Hothorn T et al., 2008), rstatix (version 0.7.2; Kassambara A,\n2023), emmeans (version 1.10.5; Lenth R, 2024), sjstats (version 0.19.0;\nL√ºdecke D, 2024), parameters (version 0.23.0; L√ºdecke D et al., 2020),\nperformance (version 0.12.4; L√ºdecke D et al., 2021), easystats (version 0.7.3;\nL√ºdecke D et al., 2022), see (version 0.8.5; L√ºdecke D et al., 2021), insight\n(version 0.20.5; L√ºdecke D et al., 2019), survey (version 4.4.2; Lumley T,\n2024), bayestestR (version 0.15.0; Makowski D et al., 2019), modelbased\n(version 0.8.8; Makowski D et al., 2020), report (version 0.5.9; Makowski D et\nal., 2023), correlation (version 0.8.5; Makowski D et al., 2022), datawizard\n(version 0.13.0; Patil I et al., 2022), nlme (version 3.1.166; Pinheiro J et\nal., 2024), foreign (version 0.8.87; R Core Team, 2024), GGally (version 2.2.1;\nSchloerke B et al., 2024), rempsyc (version 0.1.8; Th√©riault R, 2023), survival\n(version 3.7.0; Therneau T, 2024), MASS (version 7.3.60.0.1; Venables WN,\nRipley BD, 2002), ggplot2 (version 3.5.1; Wickham H, 2016), dplyr (version\n1.1.4; Wickham H et al., 2023), tidyr (version 1.3.1; Wickham H et al., 2024)\nand mime (version 0.12; Xie Y, 2021).\n\nReferences\n----------\n  - Bates D, M√§chler M, Bolker B, Walker S (2015). \"Fitting Linear Mixed-Effects\nModels Using lme4.\" _Journal of Statistical Software_, *67*(1), 1-48.\ndoi:10.18637/jss.v067.i01 <https://doi.org/10.18637/jss.v067.i01>.\n  - Bates D, Maechler M, Jagan M (2024). _Matrix: Sparse and Dense Matrix Classes\nand Methods_. R package version 1.6-5,\n<https://CRAN.R-project.org/package=Matrix>.\n  - Ben-Shachar MS, L√ºdecke D, Makowski D (2020). \"effectsize: Estimation of\nEffect Size Indices and Standardized Parameters.\" _Journal of Open Source\nSoftware_, *5*(56), 2815. doi:10.21105/joss.02815\n<https://doi.org/10.21105/joss.02815>, <https://doi.org/10.21105/joss.02815>.\n  - Carey VJ (2024). _gee: Generalized Estimation Equation Solver_. R package\nversion 4.13-27, <https://CRAN.R-project.org/package=gee>.\n  - Champely S (2020). _pwr: Basic Functions for Power Analysis_. R package\nversion 1.3-0, <https://CRAN.R-project.org/package=pwr>.\n  - Cheng J, Sievert C, Schloerke B, Chang W, Xie Y, Allen J (2024). _htmltools:\nTools for HTML_. R package version 0.5.8.1,\n<https://CRAN.R-project.org/package=htmltools>.\n  - Delignette-Muller ML, Dutang C (2015). \"fitdistrplus: An R Package for\nFitting Distributions.\" _Journal of Statistical Software_, *64*(4), 1-34.\ndoi:10.18637/jss.v064.i04 <https://doi.org/10.18637/jss.v064.i04>.\n  - Dunn PK, Smyth GK (2005). \"Series evaluation of Tweedie exponential\ndispersion models.\" _Statistics and Computing_, *15*(4), 267-280. Dunn PK,\nSmyth GK (2008). \"Evaluation of Tweedie exponential dispersion models using\nFourier inversion.\" _Statistics and Computing_, *18*(1), 73-86. Dunn PK (2022).\n_Tweedie: Evaluation of Tweedie Exponential Family Models_. R package version\n2.3.5.\n  - Feinerer I, Hornik K (2024). _tm: Text Mining Package_. R package version\n0.7-14, <https://CRAN.R-project.org/package=tm>. Feinerer I, Hornik K, Meyer D\n(2008). \"Text Mining Infrastructure in R.\" _Journal of Statistical Software_,\n*25*(5), 1-54. doi:10.18637/jss.v025.i05\n<https://doi.org/10.18637/jss.v025.i05>.\n  - Fife, A. D (2022). \"Flexplot: Graphically-based data analysis.\"\n_Psychological Methods_, *27*(4), -19. <doi.org/10.1037/met0000424>.\n  - Fox J, Weisberg S (2019). _An R Companion to Applied Regression_, 3rd\nedition. Sage, Thousand Oaks CA.\n<https://socialsciences.mcmaster.ca/jfox/Books/Companion/index.html>. Fox J,\nWeisberg S (2018). \"Visualizing Fit and Lack of Fit in Complex Regression\nModels with Predictor Effect Plots and Partial Residuals.\" _Journal of\nStatistical Software_, *87*(9), 1-27. doi:10.18637/jss.v087.i09\n<https://doi.org/10.18637/jss.v087.i09>. Fox J (2003). \"Effect Displays in R\nfor Generalised Linear Models.\" _Journal of Statistical Software_, *8*(15),\n1-27. doi:10.18637/jss.v008.i15 <https://doi.org/10.18637/jss.v008.i15>. Fox J,\nHong J (2009). \"Effect Displays in R for Multinomial and Proportional-Odds\nLogit Models: Extensions to the effects Package.\" _Journal of Statistical\nSoftware_, *32*(1), 1-24. doi:10.18637/jss.v032.i01\n<https://doi.org/10.18637/jss.v032.i01>.\n  - Fox J, Weisberg S (2019). _An R Companion to Applied Regression_, Third\nedition. Sage, Thousand Oaks CA. <https://www.john-fox.ca/Companion/>.\n  - Fox J, Weisberg S, Price B (2022). _carData: Companion to Applied Regression\nData Sets_. R package version 3.0-5,\n<https://CRAN.R-project.org/package=carData>.\n  - Genz A, Bretz F (2009). _Computation of Multivariate Normal and t\nProbabilities_, series Lecture Notes in Statistics. Springer-Verlag,\nHeidelberg. ISBN 978-3-642-01688-2.\n  - Giner G, Smyth GK (2016). \"statmod: probability calculations for the inverse\nGaussian distribution.\" _R Journal_, *8*(1), 339-351. Phipson B, Smyth GK\n(2010). \"Permutation p-values should never be zero: calculating exact p-values\nwhen permutations are randomly drawn.\" _Statistical Applications in Genetics\nand Molecular Biology_, *9*(1), Article 39. Hu Y, Smyth GK (2009). \"ELDA:\nextreme limiting dilution analysis for comparing depleted and enriched\npopulations in stem cell and other assays.\" _Journal of Immunological Methods_,\n*347*(1), 70-78. Smyth GK (2005). \"Optimization and nonlinear equations.\"\n_Encyclopedia of Biostatistics_, 3088-3095. Smyth GK (2005). \"Numerical\nintegration.\" _Encyclopedia of Biostatistics_, 3088-3095. Smyth GK (2002). \"An\nefficient algorithm for REML in heteroscedastic regression.\" _Journal of\nComputational and Graphical Statistics_, *11*, 836-847. Dunn PK, Smyth GK\n(1996). \"Randomized quantile residuals.\" _J. Comput. Graph. Statist_, *5*,\n236-244.\n  - Halekoh U, H√∏jsgaard S, Yan J (2006). \"The R Package geepack for Generalized\nEstimating Equations.\" _Journal of Statistical Software_, *15/2*, 1-11. Yan J,\nFine JP (2004). \"Estimating Equations for Association Structures.\" _Statistics\nin Medicine_, *23*, 859-880. Yan J (2002). \"geepack: Yet Another Package for\nGeneralized Estimating Equations.\" _R-News_, *2/3*, 12-14.\n  - Hornik K (2024). _NLP: Natural Language Processing Infrastructure_. R package\nversion 0.3-0, <https://CRAN.R-project.org/package=NLP>.\n  - Hothorn T (2023). _TH.data: TH's Data Archive_. R package version 1.1-2,\n<https://CRAN.R-project.org/package=TH.data>.\n  - Hothorn T, Bretz F, Westfall P (2008). \"Simultaneous Inference in General\nParametric Models.\" _Biometrical Journal_, *50*(3), 346-363.\n  - Kassambara A (2023). _rstatix: Pipe-Friendly Framework for Basic Statistical\nTests_. R package version 0.7.2, <https://CRAN.R-project.org/package=rstatix>.\n  - Lenth R (2024). _emmeans: Estimated Marginal Means, aka Least-Squares Means_.\nR package version 1.10.5, <https://CRAN.R-project.org/package=emmeans>.\n  - L√ºdecke D (2024). _sjstats: Statistical Functions for Regression Models\n(Version 0.19.0)_. doi:10.5281/zenodo.1284472\n<https://doi.org/10.5281/zenodo.1284472>,\n<https://CRAN.R-project.org/package=sjstats>.\n  - L√ºdecke D, Ben-Shachar M, Patil I, Makowski D (2020). \"Extracting, Computing\nand Exploring the Parameters of Statistical Models using R.\" _Journal of Open\nSource Software_, *5*(53), 2445. doi:10.21105/joss.02445\n<https://doi.org/10.21105/joss.02445>.\n  - L√ºdecke D, Ben-Shachar M, Patil I, Waggoner P, Makowski D (2021).\n\"performance: An R Package for Assessment, Comparison and Testing of\nStatistical Models.\" _Journal of Open Source Software_, *6*(60), 3139.\ndoi:10.21105/joss.03139 <https://doi.org/10.21105/joss.03139>.\n  - L√ºdecke D, Ben-Shachar M, Patil I, Wiernik B, Bacher E, Th√©riault R, Makowski\nD (2022). \"easystats: Framework for Easy Statistical Modeling, Visualization,\nand Reporting.\" _CRAN_. doi:10.32614/CRAN.package.easystats\n<https://doi.org/10.32614/CRAN.package.easystats>, R package,\n<https://easystats.github.io/easystats/>.\n  - L√ºdecke D, Patil I, Ben-Shachar M, Wiernik B, Waggoner P, Makowski D (2021).\n\"see: An R Package for Visualizing Statistical Models.\" _Journal of Open Source\nSoftware_, *6*(64), 3393. doi:10.21105/joss.03393\n<https://doi.org/10.21105/joss.03393>.\n  - L√ºdecke D, Waggoner P, Makowski D (2019). \"insight: A Unified Interface to\nAccess Information from Model Objects in R.\" _Journal of Open Source Software_,\n*4*(38), 1412. doi:10.21105/joss.01412 <https://doi.org/10.21105/joss.01412>.\n  - Lumley T (2024). \"survey: analysis of complex survey samples.\" R package\nversion 4.4. Lumley T (2004). \"Analysis of Complex Survey Samples.\" _Journal of\nStatistical Software_, *9*(1), 1-19. R package verson 2.2. Lumley T (2010).\n_Complex Surveys: A Guide to Analysis Using R: A Guide to Analysis Using R_.\nJohn Wiley and Sons.\n  - Makowski D, Ben-Shachar M, L√ºdecke D (2019). \"bayestestR: Describing Effects\nand their Uncertainty, Existence and Significance within the Bayesian\nFramework.\" _Journal of Open Source Software_, *4*(40), 1541.\ndoi:10.21105/joss.01541 <https://doi.org/10.21105/joss.01541>,\n<https://joss.theoj.org/papers/10.21105/joss.01541>.\n  - Makowski D, Ben-Shachar M, Patil I, L√ºdecke D (2020). \"Estimation of\nModel-Based Predictions, Contrasts and Means.\" _CRAN_.\n<https://github.com/easystats/modelbased>.\n  - Makowski D, L√ºdecke D, Patil I, Th√©riault R, Ben-Shachar M, Wiernik B (2023).\n\"Automated Results Reporting as a Practical Tool to Improve Reproducibility and\nMethodological Best Practices Adoption.\" _CRAN_.\n<https://easystats.github.io/report/>.\n  - Makowski D, Wiernik B, Patil I, L√ºdecke D, Ben-Shachar M (2022).\n\"correlation: Methods for Correlation Analysis.\" Version 0.8.3,\n<https://CRAN.R-project.org/package=correlation>. Makowski D, Ben-Shachar M,\nPatil I, L√ºdecke D (2020). \"Methods and Algorithms for Correlation Analysis in\nR.\" _Journal of Open Source Software_, *5*(51), 2306. doi:10.21105/joss.02306\n<https://doi.org/10.21105/joss.02306>,\n<https://joss.theoj.org/papers/10.21105/joss.02306>.\n  - Patil I, Makowski D, Ben-Shachar M, Wiernik B, Bacher E, L√ºdecke D (2022).\n\"datawizard: An R Package for Easy Data Preparation and Statistical\nTransformations.\" _Journal of Open Source Software_, *7*(78), 4684.\ndoi:10.21105/joss.04684 <https://doi.org/10.21105/joss.04684>.\n  - Pinheiro J, Bates D, R Core Team (2024). _nlme: Linear and Nonlinear Mixed\nEffects Models_. R package version 3.1-166,\n<https://CRAN.R-project.org/package=nlme>. Pinheiro JC, Bates DM (2000).\n_Mixed-Effects Models in S and S-PLUS_. Springer, New York. doi:10.1007/b98882\n<https://doi.org/10.1007/b98882>.\n  - R Core Team (2024). _foreign: Read Data Stored by 'Minitab', 'S', 'SAS',\n'SPSS', 'Stata', 'Systat', 'Weka', 'dBase', ..._. R package version 0.8-87,\n<https://CRAN.R-project.org/package=foreign>.\n  - R Core Team (2024). _R: A Language and Environment for Statistical\nComputing_. R Foundation for Statistical Computing, Vienna, Austria.\n<https://www.R-project.org/>.\n  - Schloerke B, Cook D, Larmarange J, Briatte F, Marbach M, Thoen E, Elberg A,\nCrowley J (2024). _GGally: Extension to 'ggplot2'_. R package version 2.2.1,\n<https://CRAN.R-project.org/package=GGally>.\n  - Th√©riault R (2023). \"rempsyc: Convenience functions for psychology.\" _Journal\nof Open Source Software_, *8*(87), 5466. doi:10.21105/joss.05466\n<https://doi.org/10.21105/joss.05466>, <https://doi.org/10.21105/joss.05466>.\n  - Therneau T (2024). _A Package for Survival Analysis in R_. R package version\n3.7-0, <https://CRAN.R-project.org/package=survival>. Terry M. Therneau,\nPatricia M. Grambsch (2000). _Modeling Survival Data: Extending the Cox Model_.\nSpringer, New York. ISBN 0-387-98784-3.\n  - Venables WN, Ripley BD (2002). _Modern Applied Statistics with S_, Fourth\nedition. Springer, New York. ISBN 0-387-95457-0,\n<https://www.stats.ox.ac.uk/pub/MASS4/>.\n  - Wickham H (2016). _ggplot2: Elegant Graphics for Data Analysis_.\nSpringer-Verlag New York. ISBN 978-3-319-24277-4,\n<https://ggplot2.tidyverse.org>.\n  - Wickham H, Fran√ßois R, Henry L, M√ºller K, Vaughan D (2023). _dplyr: A Grammar\nof Data Manipulation_. R package version 1.1.4,\n<https://CRAN.R-project.org/package=dplyr>.\n  - Wickham H, Vaughan D, Girlich M (2024). _tidyr: Tidy Messy Data_. R package\nversion 1.3.1, <https://CRAN.R-project.org/package=tidyr>.\n  - Xie Y (2021). _mime: Map Filenames to MIME Types_. R package version 0.12,\n<https://CRAN.R-project.org/package=mime>.\n```\n\n\n:::\n:::\n",
    "supporting": [
      "lista_2_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}