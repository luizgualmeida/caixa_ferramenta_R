# Lista 3: Matrizes de Covari√¢ncia {#sec-lista-3 .unnumbered}

::: {.callout-note appearance="simple" icon=false}
## Objetivo da Lista

Nesta lista, voc√™ aprender√° a **escolher a estrutura de covari√¢ncia mais adequada** para seus dados longitudinais. Compararemos quatro matrizes diferentes (Sim√©trica Composta, AR(1), Identidade e N√£o-Estruturada) usando crit√©rios de informa√ß√£o AIC e BIC.
:::

---

## üì¶ Pacotes Necess√°rios

```{r}
#| echo: true
#| message: false
#| warning: false

# Lista de pacotes
pacotes <- c(
  "emmeans",      # M√©dias marginais
  "nlme",         # Modelos mistos com estruturas de correla√ß√£o
  "flexplot",     # Visualiza√ß√µes
  "foreign",      # Importar SPSS
  "dplyr",        # Manipula√ß√£o de dados
  "multcomp",     # Compara√ß√µes m√∫ltiplas
  "effects",      # Efeitos do modelo
  "performance",  # Compara√ß√£o de modelos
  "easystats",
  "ggplot2" 
)

# Verificar e instalar
pacotes_faltantes <- pacotes[!pacotes %in% installed.packages()[, "Package"]]
if (length(pacotes_faltantes) > 0) {
  install.packages(pacotes_faltantes, dependencies = TRUE)
}

# Carregar
invisible(lapply(pacotes, library, character.only = TRUE))
cat("‚úì Pacotes carregados com sucesso!\n")
```

---

## üì• Prepara√ß√£o dos Dados

::: {.callout-important}
## Dados J√° no Formato Long!

Para esta lista, use o banco **"[New Drug (RESHAPE)](https://drive.google.com/file/d/17ViQJy-w50z6vm6VdZ1A1lbeTmUuIviB/view?usp=sharing)"** que j√° est√° em formato long.
:::

### Carregamento e Verifica√ß√£o

```{r}
#| echo: true
#| message: false
#| warning: false

# Carregar dados
dataset <- read.spss("bd_New drug_respiratory&pulseRESHAPE.sav", 
                     to.data.frame = TRUE)

# Visualizar estrutura inicial
glimpse(dataset)
```

---

### Verifica√ß√£o de Tipos de Vari√°veis

::: {.callout-important}
## ‚ö†Ô∏è Tipos de Vari√°veis S√£o Cruciais!

**SEMPRE** verifique os tipos antes de modelar. As an√°lises mudam **drasticamente** dependendo se a vari√°vel √©:
- **Fator** (`<fct>`): Categorias nominais ou ordinais
- **Num√©rica** (`<dbl>`): Valores cont√≠nuos
- **Inteiro** (`<int>`): Contagens discretas
:::

::: {.panel-tabset}

#### Problema Identificado

```{r}
#| echo: true

glimpse(dataset)
```

**Observa√ß√£o Cr√≠tica:**
- `Tempo` aparece como `<dbl>` (num√©rica cont√≠nua)
- Mas representa **categorias** ("Momento 1", "Momento 2", "Momento 3")
- N√£o h√° ordem cont√≠nua entre os momentos

#### Solu√ß√£o Aplicada

```{r}
#| echo: true

# Converter Tempo para fator
dataset$Tempo <- as.factor(dataset$Tempo)

# Verificar mudan√ßa
glimpse(dataset)
```

**Agora sim:**
- `Tempo` √© `<fct>` (fator)
- Representa categorias discretas
- An√°lise apropriada para medidas repetidas

#### Compara√ß√£o

::: {.callout-tip collapse="true"}
## üîç Por que isso importa?

**Se Tempo for num√©rica:**
- R assume rela√ß√£o **linear** entre momentos
- For√ßa pontos em uma reta
- Perde flexibilidade para padr√µes n√£o-lineares

**Se Tempo for fator:**
- R trata cada momento **independentemente**
- Permite m√©dias diferentes para cada tempo
- Detecta mudan√ßas n√£o-lineares

**Experimente:**
Rode modelos com ambas as especifica√ß√µes e compare!
:::

:::

---

## üéØ Parte A: Modelos com Diferentes Matrizes

::: {.callout-tip}
## O que s√£o Matrizes de Covari√¢ncia?

Em dados longitudinais, observa√ß√µes do mesmo sujeito s√£o **correlacionadas**. A matriz de covari√¢ncia especifica **como** modelamos essa correla√ß√£o.

**Por que importa?**
- Afeta estimativas dos efeitos fixos
- Influencia erros-padr√£o
- Altera conclus√µes estat√≠sticas
:::

---

### Matriz 1: Sim√©trica Composta (Compound Symmetry)

```{r}
#| echo: true
#| message: false
#| warning: false

model_resp_sim <- lme(
  fixed = resp ~ drug + Tempo + drug*Tempo,
  random = ~1|Sujeito,
  correlation = corCompSymm(form = ~1|Sujeito),
  data = dataset
)
```

::: {.callout-note collapse="true"}
## üìä Matriz Sim√©trica Composta

**Estrutura:**
$$
\begin{bmatrix}
1 & \rho & \rho \\
\rho & 1 & \rho \\
\rho & \rho & 1
\end{bmatrix}
$$

**Caracter√≠sticas:**
- Correla√ß√£o **constante** entre todos os pares
- Um √∫nico par√¢metro $\rho$ para estimar
- Mais simples, mais parcimoniosa

**Quando usar:**
- Dados com intervalos irregulares
- Correla√ß√£o n√£o muda com dist√¢ncia temporal
- Tamanho de amostra pequeno

**Limita√ß√µes:**
- Pouco realista para s√©ries longas
- Assume correla√ß√£o n√£o decai com tempo
:::

---

### Matriz 2: Autorregressiva de Ordem 1 - AR(1)

```{r}
#| echo: true
#| message: false
#| warning: false

model_resp_AR1 <- lme(
  fixed = resp ~ drug + Tempo + drug*Tempo,
  random = ~1|Sujeito,
  correlation = corAR1(form = ~1|Sujeito),
  data = dataset
)
```

::: {.callout-note collapse="true"}
## üìä Matriz AR(1)

**Estrutura:**
$$
\begin{bmatrix}
1 & \rho & \rho^2 \\
\rho & 1 & \rho \\
\rho^2 & \rho & 1
\end{bmatrix}
$$

**Caracter√≠sticas:**
- Correla√ß√£o **decai exponencialmente** com dist√¢ncia
- Um √∫nico par√¢metro $\rho$ (0 < œÅ < 1)
- Observa√ß√µes adjacentes mais correlacionadas

**Quando usar:**
- Medi√ß√µes **igualmente espa√ßadas** no tempo
- Expectativa de correla√ß√£o decrescente
- S√©ries temporais cl√°ssicas

**Vantagens:**
- Realista para muitos processos biol√≥gicos
- Parcimoniosa (1 par√¢metro)
- Boa rela√ß√£o vi√©s-efici√™ncia

**Exemplo:**
Se œÅ = 0.7:
- Tempos adjacentes: r = 0.70
- Tempos separados por 1: r = 0.49
- Tempos separados por 2: r = 0.34
:::

---

### Matriz 3: Identidade (Independence)

```{r}
#| echo: true
#| message: false
#| warning: false

model_resp_Iden <- lme(
  fixed = resp ~ drug + Tempo + drug*Tempo,
  random = ~1|Sujeito,
  correlation = corIdent(form = ~1|Sujeito),
  data = dataset
)
```

::: {.callout-note collapse="true"}
## üìä Matriz Identidade

**Estrutura:**
$$
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{bmatrix}
$$

**Caracter√≠sticas:**
- **Nenhuma** correla√ß√£o entre medidas
- Assume independ√™ncia total
- N√£o estima par√¢metros de correla√ß√£o

**Quando usar:**
- Baseline para compara√ß√µes
- Testes de necessidade de correla√ß√£o
- **Raramente** apropriada na pr√°tica

**Limita√ß√µes:**
- Ignora estrutura de medidas repetidas
- Subestima erros-padr√£o
- Infla erro Tipo I

**Nota:** Geralmente **n√£o √© recomendada** para dados longitudinais reais!
:::

---

### Matriz 4: N√£o-Estruturada (Unstructured)

```{r}
#| echo: true
#| message: false
#| warning: false

model_resp_Uns <- lme(
  fixed = resp ~ drug + Tempo + drug*Tempo,
  random = ~1|Sujeito,
  correlation = corSymm(form = ~1|Sujeito),
  data = dataset
)
```

::: {.callout-note collapse="true"}
## üìä Matriz N√£o-Estruturada

**Estrutura (3 tempos):**
$$
\begin{bmatrix}
1 & \rho_{12} & \rho_{13} \\
\rho_{12} & 1 & \rho_{23} \\
\rho_{13} & \rho_{23} & 1
\end{bmatrix}
$$

**Caracter√≠sticas:**
- Estima **todas** as correla√ß√µes separadamente
- M√°xima flexibilidade
- Para T tempos: estima T(T-1)/2 correla√ß√µes

**Quando usar:**
- Amostra grande (regra: n > 10 √ó par√¢metros)
- Padr√£o de correla√ß√£o desconhecido
- An√°lise explorat√≥ria

**Vantagens:**
- N√£o assume estrutura espec√≠fica
- Permite padr√µes complexos
- Mais realista quando bem estimada

**Limita√ß√µes:**
- Muitos par√¢metros para estimar
- Requer amostra grande
- Pode n√£o convergir
- Pode sobre-ajustar

**Exemplo (3 tempos):**
- 3 correla√ß√µes diferentes:
  - r(1,2) = 0.65
  - r(1,3) = 0.52
  - r(2,3) = 0.71
:::

---

## üéØ Parte B: Compara√ß√£o de Modelos

### Crit√©rios de Informa√ß√£o

::: {.callout-tip}
## AIC vs BIC

**AIC (Akaike Information Criterion):**
- Penaliza√ß√£o moderada para complexidade
- Tende a favorecer modelos mais complexos
- Foco em predi√ß√£o

**BIC (Bayesian Information Criterion):**
- Penaliza√ß√£o mais forte para complexidade
- Tende a favorecer modelos mais simples
- Foco em parcim√¥nia

**Regra geral:**
- Menor √© melhor
- Diferen√ßa > 2 = evid√™ncia moderada
- Diferen√ßa > 10 = evid√™ncia forte
:::

---

### Compara√ß√£o Manual

```{r}
#| echo: true

# Criar dataframe comparativo
df_aderencia <- data.frame(
  Modelo = c("Sim√©trica", "AR(1)", "Identidade", "N√£o-estruturada"),
  AIC = c(
    AIC(model_resp_sim),
    AIC(model_resp_AR1),
    AIC(model_resp_Iden),
    AIC(model_resp_Uns)
  ),
  BIC = c(
    BIC(model_resp_sim),
    BIC(model_resp_AR1),
    BIC(model_resp_Iden),
    BIC(model_resp_Uns)
  )
)

# Arredondar
df_aderencia$AIC <- round(df_aderencia$AIC, 2)
df_aderencia$BIC <- round(df_aderencia$BIC, 2)

# Marcar melhores modelos
df_aderencia$AIC <- ifelse(
  df_aderencia$AIC == min(df_aderencia$AIC),
  paste0(df_aderencia$AIC, " ‚òÖ"),
  df_aderencia$AIC
)

df_aderencia$BIC <- ifelse(
  df_aderencia$BIC == min(df_aderencia$BIC),
  paste0(df_aderencia$BIC, " ‚òÖ"),
  df_aderencia$BIC
)

# Exibir
knitr::kable(
  df_aderencia,
  caption = "Compara√ß√£o de Matrizes de Covari√¢ncia (‚òÖ = melhor)"
)
```

---

### Compara√ß√£o Automatizada

::: {.callout-tip}
## üöÄ Fun√ß√£o `compare_performance()`

A fun√ß√£o do pacote `performance` automatiza compara√ß√µes e calcula pesos de evid√™ncia!
:::

```{r}
#| echo: true

compare_performance(
  model_resp_sim,
  model_resp_AR1,
  model_resp_Iden,
  model_resp_Uns,
  metrics = c("AIC", "BIC"),
  rank = TRUE
)
```

::: {.callout-note collapse="true"}
## üìä Interpretando Pesos

**AIC_wt e BIC_wt** s√£o pesos de evid√™ncia:
- Variam de 0 a 1
- Somam 1 entre todos os modelos
- Interpreta√ß√£o: probabilidade relativa de ser o melhor modelo

**Exemplo:**
- AIC_wt = 0.85 ‚Üí 85% de chance de ser o melhor
- AIC_wt = 0.10 ‚Üí 10% de chance de ser o melhor

**Delta_AIC/BIC:**
- Diferen√ßa em rela√ß√£o ao melhor modelo
- 0 = melhor modelo
- > 10 = evid√™ncia muito forte contra
:::

---

### An√°lise dos Resultados

```{r}
#| echo: true

# Calcular diferen√ßas
delta_aic <- abs(AIC(model_resp_AR1) - AIC(model_resp_sim))
delta_bic <- abs(BIC(model_resp_AR1) - BIC(model_resp_sim))

cat("‚ïê‚ïê‚ïê AN√ÅLISE DE SELE√á√ÉO ‚ïê‚ïê‚ïê\n\n")

cat("Diferen√ßas do melhor vs segundo melhor:\n")
cat("  ŒîAIC:", round(delta_aic, 2), "\n")
cat("  ŒîBIC:", round(delta_bic, 2), "\n\n")

cat("Interpreta√ß√£o:\n")

if (delta_aic < 2) {
  cat("  ‚Ä¢ Modelos equivalentes (ŒîAIC < 2)\n")
} else if (delta_aic < 10) {
  cat("  ‚Ä¢ Evid√™ncia moderada para o melhor (2 < ŒîAIC < 10)\n")
} else {
  cat("  ‚Ä¢ Evid√™ncia forte para o melhor (ŒîAIC > 10)\n")
}

cat("\nConclus√£o: Modelo AR(1) apresenta melhor ajuste aos dados\n")
```

---

## üéØ Parte C: Modelo Escolhido - AR(1)

::: {.callout-tip}
## Por que AR(1) √© Adequado?

**Justificativa te√≥rica:**
A matriz AR(1) √© especialmente apropriada para estudos farmacol√≥gicos porque:

1. **Decaimento temporal:** Efeitos de drogas tendem a diminuir com o tempo
2. **Mem√≥ria de curto prazo:** Medi√ß√µes pr√≥ximas s√£o mais relacionadas
3. **Parcim√¥nia:** Apenas 1 par√¢metro, evita sobre-ajuste
4. **Intervalos regulares:** Comum em protocolos experimentais

**No contexto atual:**
- Pacientes medidos em intervalos regulares
- Expectativa de correla√ß√£o decrescente
- Efeito da droga pode persistir mas enfraquecer
:::

---

### Resultados Completos

```{r}
#| echo: true

summary(model_resp_AR1)
```

---

### Relat√≥rio Automatizado

```{r}
#| echo: true

report(model_resp_AR1)
```

---

### Interpreta√ß√£o Guiada

::: {.panel-tabset}

#### Efeitos Fixos

**Interpretar coeficientes:**

```{r}
#| echo: true

# Extrair coeficientes
coef_table <- summary(model_resp_AR1)$tTable
knitr::kable(coef_table, digits = 3)
```

**Leitura:**
- **Intercept:** M√©dia baseline do grupo refer√™ncia no tempo 1
- **drugPlacebo:** Diferen√ßa Placebo vs Droga no tempo 1
- **Tempo2/3:** Mudan√ßa ao longo do tempo no grupo droga
- **Intera√ß√µes:** Como efeito da droga muda com tempo

#### Estrutura de Correla√ß√£o

```{r}
#| echo: true

# Extrair correla√ß√£o estimada
rho <- as.numeric(coef(model_resp_AR1$modelStruct$corStruct, unconstrained = FALSE))

cat("Par√¢metro AR(1) estimado: œÅ =", round(rho, 3), "\n\n")

cat("Correla√ß√µes impl√≠citas:\n")
cat("  Tempos adjacentes (1-2, 2-3):", round(rho, 3), "\n")
cat("  Tempos separados (1-3):", round(rho^2, 3), "\n")
```

**Interpreta√ß√£o:**
- œÅ pr√≥ximo de 1: Correla√ß√£o forte e persistente
- œÅ pr√≥ximo de 0: Correla√ß√£o decai rapidamente
- œÅ = 0.5: Correla√ß√£o moderada com decaimento t√≠pico

#### Vari√¢ncias

```{r}
#| echo: true

# Componentes de vari√¢ncia
var_components <- VarCorr(model_resp_AR1)
knitr::kable(var_components)
```

**Componentes:**
- **Between-subject:** Variabilidade entre sujeitos (intercepto aleat√≥rio)
- **Within-subject:** Variabilidade residual dentro de sujeitos

:::

---

## üìä Visualiza√ß√µes Avan√ßadas

### Gr√°fico dos Efeitos

::: {.callout-tip}
## Plot em Uma Linha!

A fun√ß√£o `allEffects()` + `plot()` cria visualiza√ß√µes r√°pidas e informativas:
:::

```{r}
#| echo: true
#| message: false
#| warning: false
#| fig-width: 10
#| fig-height: 6

plot(allEffects(model_resp_AR1))
```

---

### Gr√°fico Personalizado

```{r}
#| echo: true
#| message: false
#| warning: false

# Calcular m√©dias preditas
means_pred <- emmeans(model_resp_AR1, 
                      specs = ~drug*Tempo)

# Criar gr√°fico elegante
ggplot(as.data.frame(means_pred),
       aes(x = Tempo, y = emmean, color = drug, group = drug)) +
  geom_errorbar(
    aes(ymin = lower.CL, ymax = upper.CL),
    width = 0.15,
    linewidth = 1,
    position = position_dodge(0.1)
  ) +
  geom_point(
    size = 4,
    position = position_dodge(0.1)
  ) +
  geom_line(
    linewidth = 1.2,
    position = position_dodge(0.1)
  ) +
  labs(
    title = "Efeito da Droga na Respira√ß√£o ao Longo do Tempo",
    subtitle = "Modelo com estrutura de correla√ß√£o AR(1)",
    x = "Momento de Avalia√ß√£o",
    y = "Frequ√™ncia Respirat√≥ria",
    color = "Tratamento",
    caption = "Barras de erro: IC 95%"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "bottom",
    plot.title = element_text(face = "bold", size = 16),
    panel.grid.minor = element_blank()
  ) +
  scale_color_manual(values = c("#E41A1C", "#377EB8"))
```

---

## üîß Extras: Dicas Avan√ßadas

### Mudando Grupo de Refer√™ncia

::: {.callout-tip}
## Controle de Refer√™ncia

Por padr√£o, R usa **ordem alfab√©tica** para escolher o n√≠vel de refer√™ncia. Voc√™ pode alterar isso:
:::

```{r}
#| echo: true

# Verificar n√≠vel atual
cat("N√≠veis originais:\n")
print(levels(dataset$drug))

# Mudar refer√™ncia para Placebo
dataset$drug <- relevel(dataset$drug, ref = "Placebo")

cat("\nNovos n√≠veis:\n")
print(levels(dataset$drug))
```

**Impacto:**
Agora os coeficientes comparam **Droga vs Placebo** (n√£o o contr√°rio)

---

### Comparando com Nova Refer√™ncia

```{r}
#| echo: true
#| message: false
#| warning: false

# Refazer modelo com nova refer√™ncia
model_resp_AR1_v2 <- lme(
  fixed = resp ~ drug + Tempo + drug*Tempo,
  random = ~1|Sujeito,
  correlation = corAR1(form = ~1|Sujeito),
  data = dataset
)

# Comparar coeficientes
cat("‚ïê‚ïê‚ïê COMPARA√á√ÉO DE REFER√äNCIAS ‚ïê‚ïê‚ïê\n\n")
cat("Modelo Original (ref: New Drug):\n")
print(summary(model_resp_AR1)$tTable[2, c("Value", "p-value")])

cat("\nModelo com Nova Refer√™ncia (ref: Placebo):\n")
print(summary(model_resp_AR1_v2)$tTable[2, c("Value", "p-value")])
```

::: {.callout-note}
## Interpreta√ß√£o

Note que:
- **Magnitude:** Igual em valor absoluto
- **Sinal:** Invertido
- **p-valor:** Id√™ntico
- **Interpreta√ß√£o:** Mudou de "Placebo vs Droga" para "Droga vs Placebo"
:::

---

## üéØ Desafio: An√°lise da Vari√°vel "Pulse"

::: {.callout-important}
## Sua Vez - Checklist Completo!

Replique **toda a an√°lise** para a vari√°vel **"pulse"**:

**Parte A - Modelos:**
- [ ] Matriz Sim√©trica Composta
- [ ] Matriz AR(1)
- [ ] Matriz Identidade
- [ ] Matriz N√£o-Estruturada

**Parte B - Compara√ß√µes:**
- [ ] Tabela manual de AIC/BIC
- [ ] Compara√ß√£o com `compare_performance()`
- [ ] Interpreta√ß√£o dos deltas
- [ ] Identifica√ß√£o do melhor modelo

**Parte C - Modelo Escolhido:**
- [ ] Relat√≥rio completo
- [ ] Interpreta√ß√£o dos coeficientes
- [ ] An√°lise de correla√ß√£o estimada
- [ ] Gr√°ficos dos efeitos

**Extras:**
- [ ] Testar mudan√ßa de refer√™ncia
- [ ] Comparar resultados com "resp"
- [ ] Refletir sobre diferen√ßas
:::

::: {.callout-tip}
## üí° Dicas para o Desafio

1. **Renomeie adequadamente:** `model_resp_*` ‚Üí `model_pulse_*`
2. **N√£o copie-cole:** Digite para aprender
3. **Compare matrizes:** Qual √© melhor para pulse?
4. **Reflita:** Por que pode diferir de resp?
5. **Documente:** Anote suas conclus√µes
:::

---

## üìö Material Complementar

### Aula em V√≠deo (SPSS)

{{< video https://youtu.be/gYWld1qSh9c?si=VJdZsrSYAE-2BJpA title='GMM - General Mixed Models - Aula Pr√°tica #3 (SPSS)' >}}

---

### Leituras Recomendadas

::: {.callout-note collapse="true"}
## üìñ Aprofundamento em Matrizes de Covari√¢ncia

**Recursos Online:**
- [Marginal Models - Correlated Data](https://bcheggeseth.github.io/CorrelatedData/marginal-models.html)
- Pinheiro & Bates (2000). *Mixed-Effects Models in S and S-PLUS*
- Fitzmaurice et al. (2011). *Applied Longitudinal Analysis*

**T√≥picos Avan√ßados:**
- Estruturas ARMA(p,q)
- Matrizes Toeplitz
- Bandas de covari√¢ncia
- Testes de raz√£o de verossimilhan√ßa

**Quando explorar al√©m:**
- Dados com muitos tempos (T > 5)
- Padr√µes complexos de correla√ß√£o
- Intervalos irregulares
- Compara√ß√µes formais de estruturas
:::

---

### Tabela de Decis√£o R√°pida

::: {.callout-tip collapse="true"}
## üó∫Ô∏è Guia para Escolha de Matriz

| Situa√ß√£o | Matriz Recomendada | Justificativa |
|----------|-------------------|---------------|
| Poucos tempos (T ‚â§ 3) | AR(1) ou Sim√©trica | Parcim√¥nia |
| Muitos tempos (T > 5) | AR(1) | Escalabilidade |
| Intervalos irregulares | Sim√©trica ou N√£o-estruturada | Flexibilidade temporal |
| Amostra grande (n > 100) | N√£o-estruturada | Permite explora√ß√£o |
| Amostra pequena (n < 30) | AR(1) ou Sim√©trica | Evita sobre-ajuste |
| Correla√ß√£o desconhecida | Testar m√∫ltiplas, comparar AIC | Sele√ß√£o emp√≠rica |
| S√©rie temporal cl√°ssica | AR(1) | Fundamenta√ß√£o te√≥rica |
| Medi√ß√µes muito espa√ßadas | Sim√©trica ou Identidade | Correla√ß√£o pode ser fraca |

**Regra de ouro:** Quando em d√∫vida, teste m√∫ltiplas e compare!
:::

---

## üîß Informa√ß√µes de Sess√£o

```{r}
#| echo: true

report(sessionInfo())
```

---

::: {.callout-note appearance="simple"}
## üéì Resumo da Lista 3

Nesta lista voc√™:

‚úÖ Compreendeu **quatro estruturas** de covari√¢ncia  
‚úÖ Aprendeu a **comparar modelos** via AIC/BIC  
‚úÖ Identificou a **estrutura mais adequada** aos dados  
‚úÖ Interpretou **par√¢metros de correla√ß√£o**  
‚úÖ Criou **visualiza√ß√µes profissionais**  
‚úÖ Dominou mudan√ßa de **n√≠veis de refer√™ncia**  

**Conceitos-chave:**
- Matrizes capturam correla√ß√£o entre medidas repetidas
- AR(1) assume decaimento exponencial (comum em farmacologia)
- AIC/BIC penalizam complexidade diferentemente
- Estrutura apropriada melhora estimativas e infer√™ncias

**Pr√≥ximos passos:**
- Complete an√°lise para "pulse"
- Compare qual estrutura funciona melhor
- Prepare-se para Lista 4: GzLM!
:::